<script type="text/javascript">
    RED.nodes.registerType('modify-directory',{
        category: 'FASAC',
        color: '#a6bbcf',
        inputs: 1,
        outputs: 3,
        icon: "file.png",
        outputLabels: [
            "stdout",
            "job success",
            "job failed (partially)"
        ],
        label: function() {
            return this.name||"Modify Directory";
        },
        defaults: {
            name: {value: ""},
            awxService: {type:"awx-config", required: true},
            hostSshService: {type:"host-ssh-config", required: true},
            jobTimeout: {required:true, value: 60, validate:RED.validators.number()},
        }
    });
</script>

<script type="text/html" data-template-name="modify-directory">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-awxService"><i class="fa fa-tag"></i> AWX Server</label>
        <input type="text" id="node-input-awxService" placeholder="AWX Server">
    </div>
    <div class="form-row">
        <label for="node-input-hostSshService"><i class="fa fa-tag"></i> Host SSH Config</label>
        <input type="text" id="node-input-hostSshService" placeholder="Host SSH Config">
    </div>
    <div class="form-row">
        <label for="node-input-jobTimeout"><i class="fa fa-tag"></i> Job Timeout</label>
        <input type="text" id="node-input-jobTimeout" placeholder="">
        <div class="form-tips"><b>Tip:</b> Seconds to wait until the  executed job is marked as timed out.</div>
    </div>
</script>

<script type="text/markdown" data-help-name="modify-directory">
Modifies an existing directory.

### Inputs

: msg.payload (dictionary):  A dictionary containing the parameter for modifing the directory.

### Outputs

1. Standard output
: msg.payload (string) : The standard output of the executed ansible job.

2. Job success
: msg.payload (list) : A list of job results if the job was finished successfully.

3. Job failed (partially)
: msg.payload (list) : A list of job results if the job failed (partially).

### Details

The following attributes can be set via `msg.payload`:

```
{
    path: "/example/path"                       # required, must be an absoulte directory path
    mode: "0644",                               # optional, directory mode
    owner: "user",                              # optional, owner of the directory
    group: "usergroup",                         # optional, group of the directory
    modification_time: "199907011132.20",       # optional, modification time of the directory
    modification_time_format: “%Y%m%d%H%M.%S”,  # optional, modification time format, default "%Y%m%d%H%M.%S”
    access_time: "199907011132.20",             # optional, access time of the directory
    access_time_format: “%Y%m%d%H%M.%S”,        # optional, access time format, default "%Y%m%d%H%M.%S”
    recurse: "yes | no"                         # optional, modifies the attributes of a directory recursively
}
```
If the directory does not exists, the job will fail (partially).

### References

Structure of a job response: https://docs.ansible.com/ansible-tower/3.2.3/html/towerapi/job_list.html#results

Ansible file module: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html
</script>